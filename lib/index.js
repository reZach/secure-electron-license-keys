"use strict";var _arg=_interopRequireDefault(require("arg"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.cli=cli,exports["default"]=void 0;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var crypto=require("crypto"),fs=require("fs"),path=require("path");function parseArgumentsIntoOptions(a){var b=(0,_arg["default"])({"--major":String,"--minor":String,"--expire":String,"--public":String,"--private":String,"--license":String,"--output":String,"-ma":"--major","-mi":"--minor","-e":"--expire","-pu":"--public","-pr":"--private","-l":"--license","-o":"--output"},{permissive:!1,argv:a.slice(2),stopAtPositional:!1});return{major:b["--major"]||"all",minor:b["--minor"]||"all",expire:b["--expire"]||"",public:b["--public"]||"public.key",private:b["--private"]||"private.key",license:b["--license"]||"license.data",output:b["--output"]||process.cwd()}}var cryptoKeyPairOptions={modulusLength:4096,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}};function cli(a){var b=parseArgumentsIntoOptions(a),c={major:b.major,minor:b.minor,expire:b.expire},d=crypto.generateKeyPairSync("rsa",cryptoKeyPairOptions),e=d.publicKey,f=d.privateKey,g=crypto.privateEncrypt(f,Buffer.from(JSON.stringify(c))),h=path.join(b.output,b["public"]),i=path.join(b.output,b["private"]),j=path.join(b.output,b.license);console.log("Saving public key file to '".concat(h,"'.")),fs.writeFileSync(h,e),console.log("Saving private key file to '".concat(i,"'.")),fs.writeFileSync(i,f),console.log("Saving license file to '".concat(j,"'.")),fs.writeFileSync(j,g)}var validate=function(){var a={_success:!1},b=fs.readFileSync(path.join(process.cwd(),"public.key")),c=fs.readFileSync(path.join(process.cwd(),"license.data"));try{var d=crypto.publicDecrypt(b,c);Object.assign(a,JSON.parse(d.toString("utf8"))),a._success=!0}catch(a){console.error(a)}return a},_default=validate;exports["default"]=_default;