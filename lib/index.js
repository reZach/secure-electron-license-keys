"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateLicenseResponse=exports.validateLicenseRequest=exports.preloadBindings=exports.mainBindings=exports["default"]=exports.clearMainBindings=void 0;function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,_toPropertyKey(c.key),c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==_typeof(b)?b:b+""}function _toPrimitive(a,b){if("object"!=_typeof(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=_typeof(d))return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}function _classCallCheck(b,a){if(!(b instanceof a))throw new TypeError("Cannot call a class as a function")}var path=require("path"),validateLicenseRequest=exports.validateLicenseRequest="ValidateLicense-Request",validateLicenseResponse=exports.validateLicenseResponse="ValidateLicense-Response",parseVersion=function(a){if(!a||5>a.length)return console.warn("Could not parse version since ".concat(a," doesn't seem to follow semver specifications.")),a;var b=a.split(".");return 3===b.length?{major:b[0],minor:b[1],patch:b[2]}:a},validate=function(a,b,c){var d={success:!1,appVersion:parseVersion(c.version)},e=path.join(c.root,"public.key"),f=path.join(c.root,"license.data");try{if(a.existsSync(e)&&a.existsSync(f)){var g=a.readFileSync(e),h=a.readFileSync(f),i=b.publicDecrypt(g,h);Object.assign(d,JSON.parse(i.toString("utf8"))),d.success=!0}}catch(a){console.error(a)}return d},preloadBindings=exports.preloadBindings=function(a){return{send:function(b){[validateLicenseRequest].includes(b)&&a.send(b)},onReceive:function(b,c){[validateLicenseResponse].includes(b)&&a.on(b,function(a,b){return c(b)})},clearRendererBindings:function(){a.removeAllListeners(validateLicenseResponse)}}},mainBindings=exports.mainBindings=function(a,b,c,d,e){if(!e)throw new Error("options must be defined in order for license key validation to work!");else if("undefined"==typeof e.root)throw new Error("options must contain a value for 'root'. We suggest 'process.cwd()'.");else"undefined"==typeof e.version&&console.warn("By not passing a 'version' property, the client side code will not be able to make determinations based on this value. We suggest 'app.getVersion()'.");a.on(validateLicenseRequest,function(){var a=validate(c,d,e);b.webContents.send(validateLicenseResponse,a)})},clearMainBindings=exports.clearMainBindings=function(a){a.removeAllListeners(validateLicenseRequest)},SecureElectronLicenseKeys=_createClass(function a(){_classCallCheck(this,a)}),_default=exports["default"]=SecureElectronLicenseKeys;